---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
lng_pair: id_SP_final1
title: "System Programming Ch7 - Ch8"

# post specific
# if not specified, .name will be used from _data/owner/[language].yml
author: Jiyeon Na
# multiple category is not supported
category: System Programming
# multiple tag entries are possible
tags: [SP, CH7, CH8, FINAL]
# thumbnail image for post
img: ":post_pic_sp_final1_1.png"
# disable comments on this page
#comments_disable: true

# publish date
date: 2022-12-09 15:00:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2022-01-01 10:04:30 +0900
# check the meta_common_description in _data/owner/[language].yml
#meta_description: ""

# optional
# please use the "image_viewer_on" below to enable image viewer for individual pages or posts (_posts/ or [language]/_posts folders).
# image viewer can be enabled or disabled for all posts using the "image_viewer_posts: true" setting in _data/conf/main.yml.
#image_viewer_on: true
# please use the "image_lazy_loader_on" below to enable image lazy loader for individual pages or posts (_posts/ or [language]/_posts folders).
# image lazy loader can be enabled or disabled for all posts using the "image_lazy_loader_posts: true" setting in _data/conf/main.yml.
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---

# ğŸ’¡Â Chap_7

## Memory Layout of a C Program

![memory layout](:post_pic_sp_final1_1.png){:width="700px"}

â˜ï¸ ***Memory Layout (ê°€ìƒ ë©”ëª¨ë¦¬ êµ¬ì¡°)***

- ***high address*** : ì»¤ë„ì´ ìˆìŒ
- ***stack*** : ì»¤ë„ì„ ì¹¨ë²ˆí•˜ë©´ ì•ˆë˜ê¸° ë•Œë¬¸ì— ìŠ¤íƒì€ ì•„ë˜ë¡œë§Œ ìë€ë‹¤. 
ì£¼ë¡œ ì§€ì—­ë³€ìˆ˜(ë©”ì†Œë“œ ì•ˆìœ¼ë¡œ êµ­í•œë¨), main í•¨ìˆ˜(ì‚¬ìš©ìê°€ ë§Œë“  í•¨ìˆ˜) ë‚´ì˜ ë³€ìˆ˜ê°€ ì €ì¥ë˜ëŠ” êµ¬ì¡°
- ***heap*** : ìŠ¤íƒê³¼ëŠ” ë°˜ëŒ€ë¡œ ìœ„ë¡œë§Œ ìëŒ, ìŠ¤íƒê³¼ í™ì€ ì„œë¡œ ë§Œë‚˜ëŠ” êµ¬ì¡°ë¡œ ë˜ì–´ìˆìœ¼ë©´ì„œ ì»¤ë„ì— ì ˆëŒ€ ì¹¨ë²”í•˜ì§€ ì•Šê²Œ ë˜ì–´ìˆë‹¤. 
ì‚¬ìš©ì ë©”ëª¨ë¦¬ ì˜ì—­, ë™ì í• ë‹¹ì´ ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬
- ***unitialized data & initialized data*** : í•©ì³ì„œ ë°ì´í„° ì˜ì—­
- ***text*** : ë ˆì§€ìŠ¤í„° ê°’ë“¤ì˜ ì§‘í•©

<br>

## Memory Allocation

â˜ï¸ *ë™ì í• ë‹¹ê³¼ ê´€ë ¨ëœ í•¨ìˆ˜*

- ***malloc*** : memory allocation
- ***calloc*** : mallocê³¼ ì¸ì ë‹¤ë¦„(ë‹¨ìˆœíˆ ì¸ìë§Œ ë‹¤ë¥¸ê²ƒì€ X)

```c
char* hi (char*)malloc(sizeof(char)*4); //mallocì€ ì„ ì–¸í•˜ë©´ ì“°ë ˆê¸°ê°’ ë“¤ì–´ê°
char* aloha (char*)calloc(sizeof(char), 4); //callocì€ 0ìœ¼ë¡œ ë‹¤ ì´ˆê¸°í™” í•´ì¤Œ
```

- ***realloc*** : retry allocation, ì´ë¯¸ ë§Œë“¤ì–´ì§„ ë™ì í• ë‹¹ ë©”ëª¨ë¦¬ì— ì¶”ê°€ì ìœ¼ë¡œ ë§Œë“¤ì–´ì£¼ê±°ë‚˜ ì¤„ì—¬ì£¼ëŠ” ì—­í• (ì¬í• ë‹¹), ì´ë¯¸ ë§Œë“¤ì–´ì§„ ë™ì í• ë‹¹ ë©”ëª¨ë¦¬ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒ
- ***free*** : ë©”ëª¨ë¦¬ë¥¼ í•´ì œí•  ë•Œ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜

â†’ ë©”ëª¨ë¦¬ í•´ì œ ì•ˆí•´ì¤€ ê²ƒì´ ìŒ“ì´ë©´ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ìƒê¹€, cë‚˜ c++ì€ ì‚¬ìš©ìê°€ freeë¥¼ ê¼­ í•´ì¤˜ì•¼í•¨, free ì•ˆí•´ì£¼ê³  ë™ì í• ë‹¹ì„ ê³„ì† í•˜ê³  ì“°ë©´ leak, ì¦‰ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•œë‹¤. 

- ***alloca*** : stackì—ë‹¤ê°€ ë™ì í• ë‹¹ì„ í•´ì£¼ëŠ” í•¨ìˆ˜, í•„ìš”í•œ ì´ìœ ëŠ” stackì€ í”„ë¡œê·¸ë¨ì´ ëë‚˜ë©´ ì•Œì•„ì„œ freeë¥¼ í•´ì£¼ë‹ˆê¹Œ

<br>

## *setjmp* and *longjmp* Function

â˜ï¸ (ì‹œí—˜ë¬¸ì œë¥¼ ê´€í†µí•˜ëŠ” ê°œë…, chap_10ê³¼ ì—°ê´€)

- ***setjmp*** : ê¹ƒë°œì„ ê½‚ê³ 
- ***longjmp*** : longjmpë¥¼ ë§Œë‚˜ë©´ setjmpë¡œ ëŒì•„ê°

```c
#include "apue.h"
#include <setjmp.h>

jmp_buf jmpbuffer; //jmpbufferëŠ” ì§€ê¸ˆ statusë¥¼ ì €ì¥í•˜ê³  ìˆìŒ, ìë£Œí˜•ì€ jmp_buf

int main(void) {
		char line[MAXLINE];
		
		if(setjmp(jmpbuffer) != 0) //setjmpí•¨ìˆ˜ ë§Œë‚¨, ê¹ƒë°œì„ ê½‚ìŒ
				printf("error");
		while(fgets(line, MAXLINE, stdin) != NULL)
				do_line(line);
		exit(0);
}

...

void cmd_add(void) {
		int token;
		
		token = get_token();
		if(token < 0)  /* an error has occured */
				longjmp(jmpbuffer,1); //setjmp ìœ„ì¹˜ë¡œ ì í”„í•˜ê²Œë¨, setjmpì˜ ë°˜í™˜ê°’ì€ 1
		/* rest of processing for this command */
}
```

<br>

# ğŸ’¡Â Chap_8

## *fork, vfork* Function

â˜ï¸ í”íˆ ì“°ëŠ” í¬í¬ ìƒê°í•˜ë©´ ë¨

- ***fork*** : ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì™€ ë˜‘ê°™ì€ ìì‹ í”„ë¡œì„¸ìŠ¤ë¥¼ ë³µì‚¬í•´ì„œ ë§Œë“œëŠ” í•¨ìˆ˜, *copy-on-write,*
    
    the child is copy of the parent, ëª¨ë“  ë©”ëª¨ë¦¬ ì˜ì—­ì„ ê·¸ëŒ€ë¡œ ì¹´í”¼í•¨ â†’ ì˜¤ë˜ê±¸ë¦¼
    
- ***vfork*** : ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ê°€ ê°€ì§€ê³  ìˆëŠ” ê²ƒì„ ëª¨ë‘ë‹¤ ë³µì‚¬í•˜ì§€ ì•Šê³  ì¼ë¶€ë§Œ ë³µì‚¬í•´ì„œ ìì‹í”„ë¡œì„¸ìŠ¤ë¥¼ ë§Œë“œëŠ” í•¨ìˆ˜

<br>

## *wait* and *waitpid* Function

â˜ï¸ ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ì—ì„œ ìì‹ í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ í™•ì¸í•˜ê³  ì‹¶ì„ ë•Œ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œë¥¼ ì§¬

```c
#include "apue.h"
#include <sys/wait.h>
int main(void)
{
Â Â  pid_t pid;
Â Â  int status;
Â Â  if ((pid = fork()) < 0) //ì—ëŸ¬
			err_sys("fork error");
Â Â  else if (pid == 0) // 0ì¼ë•Œ child
Â Â Â Â Â  exit(7);
	 //0ë³´ë‹¤ í° ì–‘ìˆ˜ì¼ ë•ŒëŠ” ë¶€ëª¨ í”„ë¡œì„¸ìŠ¤ë§Œ ë´ë¼
Â Â  if (wait(&status) != pid) // wait for child, ìì‹í”„ë¡œì„¸ìŠ¤ê°€ ëë‚ ë•Œê¹Œì§€
Â Â Â Â Â  err_sys("wait error");
Â Â  pr_exit(status); // and print its status

...

}
```

- fork í•¨ìˆ˜ë¡œ ìì‹í”„ë¡œì„¸ìŠ¤ë¥¼ ë§Œë“¤ê³  ë‚˜ë©´ ê°™ì€ ì½”ë“œ ì•ˆì—ì„œ ë¶„ê¸°ê°€ í•˜ë‚˜ ë” ìƒê¸°ëŠ” ê²ƒì„
- wait(&status), ìì‹í”„ë¡œì„¸ìŠ¤ì˜ ìƒíƒœë¥¼ ë¬¼ì–´ë³´ê³ , ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ëë‚ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” í•¨ìˆ˜
ìì‹ í”„ë¡œì„¸ìŠ¤ê°€ ëë‚˜ë©´ ìƒíƒœ ë°˜í™˜í•´ì¤Œ
- pr_exit(status), status ê°’ì„ ì°ì–´ì£¼ëŠ” ê²ƒ

<br>

## *exec* Function

â˜ï¸ (ë‹¨ë‹µí˜• ë‹¨ê³¨, ì´í•´í•˜ë©´ ë¨)

```c
#include <unistd.h>
int execl(const char *pathname, const char *arg0, â€¦ /* (char *) 0 */);
int execv(const char *pathname, char *const argv[]);
int execle(const char *pathname, const char *arg0, â€¦ /* (char *) 0, char *const envp[] */);
int execve(const char *pathname, char *const argv[], char *const envp[]);
int execlp(const char *filename, const char *arg0, â€¦ /* (char *) 0 */);
int execvp(const char *filename, char *const argv[]);
```

execëŠ” ëª¨ë‘ ë™ì¼, execëŠ” forkí•¨ìˆ˜ì™€ ì—°ê³„ë˜ì–´ ë§ì´ ì“°ì´ëŠ” ë­”ê°€ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜

- ***execl*** : list of argument, ì¸ìê°€ ë¦¬ìŠ¤íŠ¸ì¸ ì‹¤í–‰í•¨ìˆ˜
- ***execv*** : ì¸ìê°€ ë²¡í„°ë¡œ ë„˜ì–´ê°€ëŠ” ì‹¤í–‰í•¨ìˆ˜
- ***execle*** : ì¸ìê°€ í™˜ê²½ë³€ìˆ˜í•˜ê³  ë¦¬ìŠ¤íŠ¸ê°€ ë„˜ì–´ê°€ëŠ” ì‹¤í–‰í•¨ìˆ˜
- ***execve*** : ì¸ìê°€ í™˜ê²½ë³€ìˆ˜ì™€ ë²¡í„°ê°€ ë„˜ì–´ê°€ëŠ” ì‹¤í–‰í•¨ìˆ˜
- ***execlp*** : ì¸ìê°€ íŒŒì¼ë„¤ì„ê³¼ ë³€ìˆ˜ê°€ ë„˜ì–´ê°€ëŠ” ì‹¤í–‰í•¨ìˆ˜
- ***execvp*** : ì¸ìê°€ íŒŒì¼ë„¤ì„ê³¼ ë²¡í„°ê°€ ë„˜ì–´ê°€ëŠ” ì‹¤í–‰í•¨ìˆ˜

<br>

## *system* Fucntion

â˜ï¸ ì¸ìë¡œ ë„˜ì–´ì˜¨ shellì—ì„œ ì¹˜ëŠ” ëª…ë ¹ì–´

- í„°ë¯¸ë„ ê°™ì€ ì‰˜ì—ì„œ ì¹œ ëª…ë ¹ì–´ë¥¼ ê·¸ëŒ€ë¡œ ì¸ìë¡œ ë°›ì•„ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë©”ì†Œë“œ
- shell ëª…ë ¹ì–´ë¥¼ ë¬¸ìì—´ë¡œ ë°›ì•„ì„œ ì‹¤í–‰ì‹œì¼œì£¼ëŠ” í•¨ìˆ˜
