---
# multilingual page pair id, this must pair with translations of this page. (This name must be unique)
lng_pair: id_SP_midterm3
title: "System Programming Ch4"

# post specific
# if not specified, .name will be used from _data/owner/[language].yml
author: Jiyeon Na
# multiple category is not supported
category: System Programming
# multiple tag entries are possible
tags: [SP, MIDTERM]
# thumbnail image for post
img: ":post_pic_sp_midterm3_1.png"
# disable comments on this page
#comments_disable: true

# publish date
date: 2022-10-21 15:00:00 +0900

# seo
# if not specified, date will be used.
#meta_modify_date: 2022-01-01 10:04:30 +0900
# check the meta_common_description in _data/owner/[language].yml
#meta_description: ""

# optional
# please use the "image_viewer_on" below to enable image viewer for individual pages or posts (_posts/ or [language]/_posts folders).
# image viewer can be enabled or disabled for all posts using the "image_viewer_posts: true" setting in _data/conf/main.yml.
#image_viewer_on: true
# please use the "image_lazy_loader_on" below to enable image lazy loader for individual pages or posts (_posts/ or [language]/_posts folders).
# image lazy loader can be enabled or disabled for all posts using the "image_lazy_loader_posts: true" setting in _data/conf/main.yml.
#image_lazy_loader_on: true
# exclude from on site search
#on_site_search_exclude: true
# exclude from search engines
#search_engine_exclude: true
# to disable this page, simply set published: false or delete this file
#published: false
---

# ğŸ’¡Â Chap_4

## stat, fstat, and lstat

```c
#include <sys/stat.h>
int stat(const char *pathname, struct stat *buf);
int fstat(int filedes, struct stat *buf);
int lstat(const char *pathname, struct stat *buf);
```


ğŸ“ ***stat, fstat :*** íŒŒì¼ êµ¬ì¡°ì— ëŒ€í•œ ì„¤ëª…ì„ ì¶œë ¥í•œë‹¤

- íŒŒì¼ êµ¬ì¡° : i-nodeì— ìˆëŠ” ì •ë³´ ì¤‘ì— ì‚¬ì´ì¦ˆ ë¸”ë¡, ë°ì´í„° ëª‡ê°œê°€ ì“°ì„, ì†Œìœ ì£¼ê°€ ëˆ„êµ¬ì•¼.. ë“±ë“± ì´ i-nodeë¥¼ ì°¸ì¡°í•´ì„œ ë³´ì—¬ì£¼ëŠ” ê²ƒ

***lstat*** : ì•ì— ë¶™ì€ lì€ link, symbolic linkì˜ íŒŒì¼ êµ¬ì¡°ë‚˜ ì •ë³´ë¥¼ ë°˜í™˜

<br>


## Set-User-ID and Set-Group-ID

![Set-User-ID and Set-Group-ID](:post_pic_sp_midterm3_1.png){:width="700px"}

ì‹¤ìŠµ 6ì£¼ì°¨ ê°•ì˜ ìë£Œ


ğŸ“ setuid - 4 (userì— super ê¶Œí•œ)
setgid - 2 (groupì— super ê¶Œí•œ)
sticky bit - 1 (otherì— super ê¶Œí•œ)

<br>

## File Access Permissions


ğŸ“ ***Directory***

R - to obtain a list of all the file names in the dir
W - to create/delete a file in the directory, both X and W are necessary
X - to pass through the directory comprising a pathname, also called *â€œsearch bitâ€*

***File***

R - O_RDONLY and O_RDWR for the *open* function

W - O_WRONLY, O_RDWR, O_TRUNC
X - *exec* functions

**(ë‹¨ë‹µí˜•)** ë””ë ‰í† ë¦¬ì— ìƒˆë¡œìš´ íŒŒì¼ì„ ë§Œë“¤ ë•Œ í•„ìš”í•œ ê¶Œí•œì€ ë¬´ì—‡ì¸ê°€?

â‡’ X, W

**(ë‹¨ë‹µí˜•)** ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•˜ëŠ” íŒŒì¼ì„ ì§€ìš¸ ë•Œ í•„ìš”í•œ ê¶Œí•œì€ ë¬´ì—‡ì¸ê°€?

â‡’ X, W




ğŸ“ ***access Function***

- ì ‘ê·¼ ê¶Œí•œì´ ìœ íš¨í•œì§€ë¥¼ íŒë‹¨í•´ì„œ ë°˜í™˜í•´ì£¼ëŠ” í•¨ìˆ˜
- ì ‘ê·¼í•  ë•Œ ì“°ëŠ” ê²ƒì´ ì•„ë‹Œ, ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ë¥¼ ë°˜í™˜í•´ì¤Œ

```c
#include <unistd.h>
int access(const char *pathname, int mode);
```

mode : R_OK(Rê¶Œí•œì´ ì—†ìœ¼ë©´ 0 ë°˜í™˜, ìˆìœ¼ë©´ ì–‘ìˆ˜ ë°˜í™˜), W_OK, X_OK, F_OK(R,W,X ì „ë¶€ ë‹¤)




ğŸ“ ***umask Function***

```c
#include <sys/stat.h>
mode_t umask(mode_t, cmask);
```

- íŒŒì¼ì´ë‚˜ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•  ë•Œ, ì´ˆê¸°ê¶Œí•œì„ ë­˜ë¡œ ì¤„ì§€ ê²°ì •ì§€ì„ ìˆ˜ ìˆëŠ” í•¨ìˆ˜

- íŒŒì¼ì€ ì‹¤í–‰ê¶Œí•œ(X)ì´ í•„ìš”ì—†ìŒ ì¦‰, íŒŒì¼ì˜ ìµœëŒ€ê¶Œí•œì€ 666
    
    
    | íŒŒì¼ì˜ ìµœëŒ€ ê¶Œí•œ | 666 | 666 |
    | --- | --- | --- |
    | umask | 002 | 004 |
    | umaskë¥¼ ë§Œë“¤ê³  ë°”ë€ ê¶Œí•œ | 664 | 662 |
- umaskëŠ” íŒŒì¼ì˜ ìµœëŒ€ê¶Œí•œì—ì„œ ì§€ê¸ˆ ì„¸íŒ…ë˜ì–´ìˆëŠ” ìœ ë§ˆìŠ¤í¬ ê°’ì„ ëº€ ê°’ìœ¼ë¡œ íŒŒì¼ì„ ìƒì„±í•¨
- umaskëŠ” í•¨ìˆ˜, cmaskëŠ” ì¸ì (umaskì™€ cmask ê°’ì˜ ì˜ë¯¸ëŠ” ë™ì¼)

```c
#include "apue.h"
#include <fcntl.h>
#define RWRWRW (S_IRUSR|S_IWUSR|S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH)

int main(void)
{ //íŒŒì¼ì˜ ìµœëŒ€ ê¶Œí•œì€ 666
	umask(0); //umask 0
	if(creat("foo", RWRWRW) < 0) //fooëŠ” 666ìœ¼ë¡œ ìƒì„±
		err_sys("creat error for foo")
	umask(S_IRGRP|S_IWGRP|S_IROTH|S_IWOTH); //umask 066

	if(creat("bar", RWRWRW) < 0)//barëŠ” 600ìœ¼ë¡œ ìƒì„±
		err_sys("creat error for bar");

	exit(0);
}
```

![umask Function](:post_pic_sp_midterm3_2.png){:width="700px"}




ğŸ“ ***chmod, fchmod Functions***

- ***chmod*** : change mode, íŒŒì¼ì˜ ì ‘ê·¼ ê¶Œí•œì„ ë°”ê¿€ ë•Œ ì“°ëŠ” í•¨ìˆ˜
- ***fchmod*** : ê°™ì€ ì—­í• , ì¸ìë§Œ ë‹¤ë¦„



ğŸ“ ***Sticky Bit***

- 1000ìœ¼ë¡œ ì„¸íŒ…ëœ íŠ¹ìˆ˜ê¶Œí•œ



ğŸ“ ***chown, fchown, and lchown***

- ***chown*** : ì†Œìœ ìì™€ ì†Œìœ ê·¸ë£¹ì„ ë°”ê¾¸ëŠ” í•¨ìˆ˜
- ***fchown*** : ì¸ìë§Œ ë‹¤ë¦„
- ***lchown*** : symbolic link ìì²´ì˜ ì†Œìœ ì£¼ì™€ ì†Œìœ ê·¸ë£¹ì„ ë°”ê¿ˆ



ğŸ“ ***File Truncation***

**(ë‹¨ë‹µí˜•)** ë‹¤ìŒ ì¤‘ ì¸ìë¡œ ë„˜ê²¨ì£¼ëŠ” lengthë§Œí¼ ì˜ë¼ë‚´ëŠ” í•¨ìˆ˜ëŠ” ë¬´ì—‡ì¸ê°€?

â‡’ ***truncate, ftruncate***

<br>

## Symbolic Links (ì‹œí—˜ë¬¸ì œ 100% ë‚˜ì˜´)

![symbolic link](:post_pic_sp_midterm3_3.png){:width="700px"}

ê·¸ë¦¼, ì½”ë“œ ì „ë¶€ ì™¸ìš°ê¸°


ğŸ“

- foo directory ì•ˆì— file a ë‘ testdir directoryê°€ ìˆìŒ
- ln -s ../foo  foo/testdir
    
    â€”> testdirì´ ìê¸° ë¶€ëª¨ì¸ foo directoryë¥¼ í¬ì¸íŒ…í•¨ (symbolic linkë¥¼ ê±¸ì—ˆìŒ)
    

*directoryë¥¼ link ê±¸ ìˆ˜ ìˆëŠ” ê±´ ë¬´ì¡°ê±´ ì˜¤ë¡œì§€ root ì‚¬ìš©ìë§Œ (superuserë§Œ)




ğŸ“ ***Symbolic Links***

![symbolic link](:post_pic_sp_midterm3_4.png){:width="700px"}

- symbolic link (=soft link) ëŠ” hard link ì™€ ëŒ€ë¹„ë¨
- H1ì„ ì†ŒìŠ¤ë¡œ í•˜ëŠ” hard linkë¥¼ ê±´ H2, H3ë¥¼ ìƒì„±í•˜ë©´ ìœ„ì™€ ê°™ì€ í˜•íƒœê°€ ë¨
- Hard linkëŠ” ê°™ì€ i-nodeë¥¼ ê°€ë¦¬í‚´
- soft linkëŠ” s1ì„ ì›ë³¸ìœ¼ë¡œ s2ë¥¼ ë§Œë“¤ ë•Œ, s2ëŠ” ë…ë¦½ì ì¸ i-nodeë¥¼ í¬ì¸íŒ… í•˜ëŠ”ë°, ê·¸ i-nodeê°€ originì„ í¬ì¸íŒ…í•˜ê²Œë¨
- hard linkëŠ” H1ì„ ì‚­ì œí•´ë„ H2, H3ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šì§€ë§Œ,
- soft linkëŠ” S1ì„ ì‚­ì œí•˜ë©´ i-nodeë„ ê°™ì´ ì‚­ì œë˜ë¯€ë¡œ S2ë¥¼ ì—´ ìˆ˜ ì—†ìŒ
- soft linkëŠ” ë°”ë¡œê°€ê¸° ë¼ê³  í•¨, ì›ë³¸ì„ ë³µì œëŠ” í•˜ì§€ë§Œ ê·¸ ìì²´ë¥¼ ë³µì œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ê·¸ ì›ë³¸ì„ í¬ì¸íŒ…í•˜ëŠ” ë­”ê°€ë¥¼ ë§Œë“¬



ğŸ“ ***symlink, readlink Function***

```c
#include <unistd.h>
int symlink(const char *actualpath, const char *sympath);
```

***symlink*** : symbolic linkë¥¼ ìƒì„±í•  ë•Œ ì“°ëŠ” í•¨ìˆ˜

```c
#include <unistd.h>
ssize_t readlink(const char *pathname, char *buf, size_t bufsize);
```

***readlink*** : linkê°€ ê±¸ë ¤ìˆëŠ”, ì‹¤ì œ í¬ì¸íŒ…í•˜ê³  ìˆëŠ” íŒŒì¼ì„ ì˜¤í”ˆí•´ì£¼ëŠ”, ì½ì–´ì£¼ëŠ” í•¨ìˆ˜ (equivalent to the actions of *open, read, and close*)




ğŸ“ ***link, unlink, remove, and rename Functions***

- ***link*** : hard linkë¥¼ ë§Œë“¬
- ***unlink***
- ***remove*** : fileì— ì“°ë©´ unllinkì™€ ê°™ì€ íš¨ê³¼, ë””ë ‰í† ë¦¬ì— ì“°ë©´ rmdirê³¼ ê°™ì€ íš¨ê³¼
- ***rename***

symclinkë¥¼ ì„¤ëª…í•  ë•ŒëŠ” ë¬´ì¡°ê±´ symbolic linkê°€ ë‚˜ì˜´

ì´ëŸ° ë‚´ìš©ì´ ì•ˆë‚˜ì˜¤ë©´ ë¬´ì¡°ê±´ link í•¨ìˆ˜




ğŸ“ ***utime Function***

```c
#include <sys/types.h>
#include <utime.h>
int utime(const char *pathname, const struct utimbuf *times);
struct utimbuf{
	time_t actime /* access time */
	time_t modtime /* modification time */
}
```

- íŒŒì¼ì— ì ‘ê·¼í•œ ì‹œê°„(ìƒì„±í•œ ì‹œê°„)ê³¼ ë³€ê²½í•œ ì‹œê°„ì„ ì•Œê³  ì‹¶ì„ ë•Œ ì“°ëŠ” í•¨ìˆ˜



ğŸ“ ***mkdir and rmdir Fuction***
***mkdir*** : make directory
***rmdir*** : remove directory




ğŸ“ ***chdir, fchdir, and getcwd***

***chdir*** : change directory, ë‚´ê°€ í˜„ì¬ ì‘ì—…í•˜ê³  ìˆëŠ” ê³³(working directory)ì˜ ê²½ë¡œë¥¼ ë°”ê¿€ ë•Œ ì“°ëŠ” í•¨ìˆ˜

***fchdir*** : ì¸ìë§Œ ë‹¤ë¦„

***getcwd*** : current working directoryì˜ ê²½ë¡œë¥¼ ê°€ì§€ê³  ì˜¤ëŠ” í•¨ìˆ˜

